#!/bin/bash

# ุฅุนุฏุงุฏ ููู ุงูุจูุฆุฉ ููุชุทุจูู
echo "๐ง ุฅุนุฏุงุฏ ููู ุงูุจูุฆุฉ..."

# ุฅูุดุงุก ููู .env.local ุฅุฐุง ูู ููู ููุฌูุฏุงู
if [ ! -f .env.local ]; then
    echo "๐ ุฅูุดุงุก ููู .env.local..."
    cp env-template.txt .env.local
    echo "โ ุชู ุฅูุดุงุก ููู .env.local"
else
    echo "โ๏ธ  ููู .env.local ููุฌูุฏ ุจุงููุนู"
    echo "ูู ุชุฑูุฏ ุงุณุชุจุฏุงููุ (y/n)"
    read -r response
    if [[ "$response" =~ ^([yY][eE][sS]|[yY])$ ]]; then
        cp env-template.txt .env.local
        echo "โ ุชู ุชุญุฏูุซ ููู .env.local"
    else
        echo "โ ุชู ุฅูุบุงุก ุงูุนูููุฉ"
        exit 0
    fi
fi

# ุฅูุดุงุก ูุฌูุฏ ุงูุชุฎุฒูู
mkdir -p user-storage
echo "โ ุชู ุฅูุดุงุก ูุฌูุฏ ุงูุชุฎุฒูู"

# ุชุซุจูุช ุงูุชุจุนูุงุช ุฅุฐุง ูุฒู ุงูุฃูุฑ
if [ ! -d node_modules ]; then
    echo "๐ฆ ุชุซุจูุช ุงูุชุจุนูุงุช..."
    npm install
fi

echo ""
echo "๐ ุชู ุฅุนุฏุงุฏ ุงูุจูุฆุฉ ุจูุฌุงุญ!"
echo ""
echo "๐ ุงูุฎุทูุงุช ุงูุชุงููุฉ:"
echo "1. ุชุญุฑูุฑ ููู .env.local ูุฅุถุงูุฉ ุฅุนุฏุงุฏุงุช ุงูุฅูููู ุงูุฎุงุตุฉ ุจู"
echo "2. ุชุดุบูู ุงูุชุทุจูู: npm run dev"
echo "3. ูุชุญ ุงููุชุตูุญ ุนูู: http://localhost:3000"
echo ""
echo "๐ก ูุตุงุฆุญ:"
echo "- ุงุชุฑูู EMAIL_DEV_MODE=true ููุชุทููุฑ (ูุญุงูุงุฉ ุงูุฅุฑุณุงู)"
echo "- ุบูุฑู ุฅูู EMAIL_DEV_MODE=false ููุฅูุชุงุฌ ูุน ุฅุนุฏุงุฏุงุช SMTP ุตุญูุญุฉ"
echo "- ุงุณุชุฎุฏูู Gmail ูุน App Password ููุณูููุฉ"
echo ""
